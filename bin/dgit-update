#!/bin/bash
SOURCE="$(readlink -f $(dirname $BASH_SOURCE))"
source "$SOURCE/dgit-locations"

#Determine branch name
if [ -e ../"repobranch" ]
then
	read uname < ../repobranch
	echo "Using ../repobranch to determine the uname. uname is $uname" &>> "$dgitlog"
else
	uname=$(id -un)
	echo "Using id -un to determine the uname. uname is $uname" &>> "$dgitlog"
fi

#Add all files in the directory, commit them
git add . &>> "$dgitlog"
git commit -m "Automated commit." &>> "$dgitlog"

#Pull any changes since last update
git pull "origin" "$uname" &>> "$dgitlog"

#Push the changes to local branch since last update. Create remote branch if needed
git push "origin" "$uname" &>> "$dgitlog"

#then
zenity --info --title="Updated successfully" --text="The main store has been successfully updated."
#else
#	zenity --error --title="Error updating" --text="There was an error updating the main store.\nPlease contact an administrator."
#fi
